(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))c(l);new MutationObserver(l=>{for(const m of l)if(m.type==="childList")for(const f of m.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function a(l){const m={};return l.integrity&&(m.integrity=l.integrity),l.referrerPolicy&&(m.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?m.credentials="include":l.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function c(l){if(l.ep)return;l.ep=!0;const m=a(l);fetch(l.href,m)}})();var _e={exports:{}};(function(e){var n=function(a){var c=Object.prototype,l=c.hasOwnProperty,m=Object.defineProperty||function(o,t,s){o[t]=s.value},f,v=typeof Symbol=="function"?Symbol:{},L=v.iterator||"@@iterator",E=v.asyncIterator||"@@asyncIterator",R=v.toStringTag||"@@toStringTag";function h(o,t,s){return Object.defineProperty(o,t,{value:s,enumerable:!0,configurable:!0,writable:!0}),o[t]}try{h({},"")}catch{h=function(t,s,u){return t[s]=u}}function S(o,t,s,u){var r=t&&t.prototype instanceof q?t:q,i=Object.create(r.prototype),d=new Z(u||[]);return m(i,"_invoke",{value:oe(o,s,d)}),i}a.wrap=S;function _(o,t,s){try{return{type:"normal",arg:o.call(t,s)}}catch(u){return{type:"throw",arg:u}}}var j="suspendedStart",I="suspendedYield",N="executing",C="completed",y={};function q(){}function F(){}function b(){}var J={};h(J,L,function(){return this});var x=Object.getPrototypeOf,B=x&&x(x(Q([])));B&&B!==c&&l.call(B,L)&&(J=B);var M=b.prototype=q.prototype=Object.create(J);F.prototype=b,m(M,"constructor",{value:b,configurable:!0}),m(b,"constructor",{value:F,configurable:!0}),F.displayName=h(b,R,"GeneratorFunction");function ee(o){["next","throw","return"].forEach(function(t){h(o,t,function(s){return this._invoke(t,s)})})}a.isGeneratorFunction=function(o){var t=typeof o=="function"&&o.constructor;return t?t===F||(t.displayName||t.name)==="GeneratorFunction":!1},a.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,b):(o.__proto__=b,h(o,R,"GeneratorFunction")),o.prototype=Object.create(M),o},a.awrap=function(o){return{__await:o}};function Y(o,t){function s(i,d,p,g){var w=_(o[i],o,d);if(w.type==="throw")g(w.arg);else{var D=w.arg,$=D.value;return $&&typeof $=="object"&&l.call($,"__await")?t.resolve($.__await).then(function(P){s("next",P,p,g)},function(P){s("throw",P,p,g)}):t.resolve($).then(function(P){D.value=P,p(D)},function(P){return s("throw",P,p,g)})}}var u;function r(i,d){function p(){return new t(function(g,w){s(i,d,g,w)})}return u=u?u.then(p,p):p()}m(this,"_invoke",{value:r})}ee(Y.prototype),h(Y.prototype,E,function(){return this}),a.AsyncIterator=Y,a.async=function(o,t,s,u,r){r===void 0&&(r=Promise);var i=new Y(S(o,t,s,u),r);return a.isGeneratorFunction(t)?i:i.next().then(function(d){return d.done?d.value:i.next()})};function oe(o,t,s){var u=j;return function(i,d){if(u===N)throw new Error("Generator is already running");if(u===C){if(i==="throw")throw d;return te()}for(s.method=i,s.arg=d;;){var p=s.delegate;if(p){var g=V(p,s);if(g){if(g===y)continue;return g}}if(s.method==="next")s.sent=s._sent=s.arg;else if(s.method==="throw"){if(u===j)throw u=C,s.arg;s.dispatchException(s.arg)}else s.method==="return"&&s.abrupt("return",s.arg);u=N;var w=_(o,t,s);if(w.type==="normal"){if(u=s.done?C:I,w.arg===y)continue;return{value:w.arg,done:s.done}}else w.type==="throw"&&(u=C,s.method="throw",s.arg=w.arg)}}}function V(o,t){var s=t.method,u=o.iterator[s];if(u===f)return t.delegate=null,s==="throw"&&o.iterator.return&&(t.method="return",t.arg=f,V(o,t),t.method==="throw")||s!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+s+"' method")),y;var r=_(u,o.iterator,t.arg);if(r.type==="throw")return t.method="throw",t.arg=r.arg,t.delegate=null,y;var i=r.arg;if(!i)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y;if(i.done)t[o.resultName]=i.value,t.next=o.nextLoc,t.method!=="return"&&(t.method="next",t.arg=f);else return i;return t.delegate=null,y}ee(M),h(M,R,"Generator"),h(M,L,function(){return this}),h(M,"toString",function(){return"[object Generator]"});function ne(o){var t={tryLoc:o[0]};1 in o&&(t.catchLoc=o[1]),2 in o&&(t.finallyLoc=o[2],t.afterLoc=o[3]),this.tryEntries.push(t)}function U(o){var t=o.completion||{};t.type="normal",delete t.arg,o.completion=t}function Z(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(ne,this),this.reset(!0)}a.keys=function(o){var t=Object(o),s=[];for(var u in t)s.push(u);return s.reverse(),function r(){for(;s.length;){var i=s.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}};function Q(o){if(o){var t=o[L];if(t)return t.call(o);if(typeof o.next=="function")return o;if(!isNaN(o.length)){var s=-1,u=function r(){for(;++s<o.length;)if(l.call(o,s))return r.value=o[s],r.done=!1,r;return r.value=f,r.done=!0,r};return u.next=u}}return{next:te}}a.values=Q;function te(){return{value:f,done:!0}}return Z.prototype={constructor:Z,reset:function(o){if(this.prev=0,this.next=0,this.sent=this._sent=f,this.done=!1,this.delegate=null,this.method="next",this.arg=f,this.tryEntries.forEach(U),!o)for(var t in this)t.charAt(0)==="t"&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=f)},stop:function(){this.done=!0;var o=this.tryEntries[0],t=o.completion;if(t.type==="throw")throw t.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var t=this;function s(g,w){return i.type="throw",i.arg=o,t.next=g,w&&(t.method="next",t.arg=f),!!w}for(var u=this.tryEntries.length-1;u>=0;--u){var r=this.tryEntries[u],i=r.completion;if(r.tryLoc==="root")return s("end");if(r.tryLoc<=this.prev){var d=l.call(r,"catchLoc"),p=l.call(r,"finallyLoc");if(d&&p){if(this.prev<r.catchLoc)return s(r.catchLoc,!0);if(this.prev<r.finallyLoc)return s(r.finallyLoc)}else if(d){if(this.prev<r.catchLoc)return s(r.catchLoc,!0)}else if(p){if(this.prev<r.finallyLoc)return s(r.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(o,t){for(var s=this.tryEntries.length-1;s>=0;--s){var u=this.tryEntries[s];if(u.tryLoc<=this.prev&&l.call(u,"finallyLoc")&&this.prev<u.finallyLoc){var r=u;break}}r&&(o==="break"||o==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=o,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,y):this.complete(i)},complete:function(o,t){if(o.type==="throw")throw o.arg;return o.type==="break"||o.type==="continue"?this.next=o.arg:o.type==="return"?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):o.type==="normal"&&t&&(this.next=t),y},finish:function(o){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.finallyLoc===o)return this.complete(s.completion,s.afterLoc),U(s),y}},catch:function(o){for(var t=this.tryEntries.length-1;t>=0;--t){var s=this.tryEntries[t];if(s.tryLoc===o){var u=s.completion;if(u.type==="throw"){var r=u.arg;U(s)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(o,t,s){return this.delegate={iterator:Q(o),resultName:t,nextLoc:s},this.method==="next"&&(this.arg=f),y}},a}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(_e);var ue=(e,n)=>`${e}-${n}-${Math.random().toString(16).slice(3,8)}`;const $e=ue;let ge=0;var Le=({id:e,action:n,payload:a={}})=>{let c=e;return typeof c>"u"&&(c=$e("Job",ge),ge+=1),{id:c,action:n,payload:a}},K={};let de=!1;K.logging=de;K.setLogging=e=>{de=e};K.log=(...e)=>de?console.log.apply(globalThis,e):null;const Pe=Le,{log:re}=K,je=ue;let me=0;var Ie=()=>{const e=je("Scheduler",me),n={},a={};let c=[];me+=1;const l=()=>c.length,m=()=>Object.keys(n).length,f=()=>{if(c.length!==0){const h=Object.keys(n);for(let S=0;S<h.length;S+=1)if(typeof a[h[S]]>"u"){c[0](n[h[S]]);break}}},v=(h,S)=>new Promise((_,j)=>{const I=Pe({action:h,payload:S});c.push(async N=>{c.shift(),a[N.id]=I;try{_(await N[h].apply(globalThis,[...S,I.id]))}catch(C){j(C)}finally{delete a[N.id],f()}}),re(`[${e}]: Add ${I.id} to JobQueue`),re(`[${e}]: JobQueue length=${c.length}`),f()});return{addWorker:h=>(n[h.id]=h,re(`[${e}]: Add ${h.id}`),re(`[${e}]: Number of workers=${m()}`),f(),h.id),addJob:async(h,...S)=>{if(m()===0)throw Error(`[${e}]: You need to have at least one worker before adding jobs`);return v(h,S)},terminate:async()=>{Object.keys(n).forEach(async h=>{await n[h].terminate()}),c=[]},getQueueLen:l,getNumWorkers:m}};function Ne(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function Ce(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var Me=Ce;const De=Me;var ze=e=>{const n={};return typeof WorkerGlobalScope<"u"?n.type="webworker":De()?n.type="electron":typeof document=="object"?n.type="browser":typeof process=="object"&&typeof Ne=="function"&&(n.type="node"),typeof e>"u"?n:n[e]};const Ge=ze("type")==="browser",Fe=Ge?e=>new URL(e,window.location.href).href:e=>e;var Ue=e=>{const n={...e};return["corePath","workerPath","langPath"].forEach(a=>{e[a]&&(n[a]=Fe(n[a]))}),n},We=e=>{const n=[],a=[],c=[],l=[],m=[];return e.blocks&&e.blocks.forEach(f=>{f.paragraphs.forEach(v=>{v.lines.forEach(L=>{L.words.forEach(E=>{E.symbols.forEach(R=>{m.push({...R,page:e,block:f,paragraph:v,line:L,word:E})}),l.push({...E,page:e,block:f,paragraph:v,line:L})}),c.push({...L,page:e,block:f,paragraph:v})}),a.push({...v,page:e,block:f})}),n.push({...f,page:e})}),{...e,blocks:n,paragraphs:a,lines:c,words:l,symbols:m}},Se={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const qe="tesseract.js",Be="5.0.5",Ye="Pure Javascript Multilingual OCR",He="src/index.js",Ke="src/index.d.ts",Je="dist/tesseract.min.js",xe="dist/tesseract.min.js",Ve={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},Ze={"./src/worker/node/index.js":"./src/worker/browser/index.js"},Qe="",Xe=["jeromewu"],et="Apache-2.0",tt={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},rt={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^5.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},ot={"@rollup/pluginutils":"^5.0.2"},nt={type:"git",url:"https://github.com/naptha/tesseract.js.git"},st={url:"https://github.com/naptha/tesseract.js/issues"},it="https://github.com/naptha/tesseract.js",at={type:"opencollective",url:"https://opencollective.com/tesseractjs"},ct={name:qe,version:Be,description:Ye,main:He,types:Ke,unpkg:Je,jsdelivr:xe,scripts:Ve,browser:Ze,author:Qe,contributors:Xe,license:et,devDependencies:tt,dependencies:rt,overrides:ot,repository:nt,bugs:st,homepage:it,collective:at};var lt={workerBlobURL:!0,logger:()=>{}};const ut=ct.version,dt=lt;var ft={...dt,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${ut}/dist/worker.min.js`},ht=({workerPath:e,workerBlobURL:n})=>{let a;if(Blob&&URL&&n){const c=new Blob([`importScripts("${e}");`],{type:"application/javascript"});a=new Worker(URL.createObjectURL(c))}else a=new Worker(e);return a},pt=e=>{e.terminate()},gt=(e,n)=>{e.onmessage=({data:a})=>{n(a)}},mt=async(e,n)=>{e.postMessage(n)};const se=e=>new Promise((n,a)=>{const c=new FileReader;c.onload=()=>{n(c.result)},c.onerror=({target:{error:{code:l}}})=>{a(Error(`File could not be read! Code=${l}`))},c.readAsArrayBuffer(e)}),ae=async e=>{let n=e;if(typeof e>"u")return"undefined";if(typeof e=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(e)?n=atob(e.split(",")[1]).split("").map(a=>a.charCodeAt(0)):n=await(await fetch(e)).arrayBuffer();else if(typeof HTMLElement<"u"&&e instanceof HTMLElement)e.tagName==="IMG"&&(n=await ae(e.src)),e.tagName==="VIDEO"&&(n=await ae(e.poster)),e.tagName==="CANVAS"&&await new Promise(a=>{e.toBlob(async c=>{n=await se(c),a()})});else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas){const a=await e.convertToBlob();n=await se(a)}else(e instanceof File||e instanceof Blob)&&(n=await se(e));return new Uint8Array(n)};var vt=ae;const wt=ft,yt=ht,bt=pt,Lt=gt,St=mt,Et=vt;var kt={defaultOptions:wt,spawnWorker:yt,terminateWorker:bt,onMessage:Lt,send:St,loadImage:Et};const Ot=Ue,At=We,k=Le,{log:ve}=K,Tt=ue,W=Se,{defaultOptions:Rt,spawnWorker:_t,terminateWorker:$t,onMessage:Pt,loadImage:we,send:jt}=kt;let ye=0;var Ee=async(e="eng",n=W.LSTM_ONLY,a={},c={})=>{const l=Tt("Worker",ye),{logger:m,errorHandler:f,...v}=Ot({...Rt,...a}),L={},E={},R=typeof e=="string"?e.split("+"):e;let h=n,S=c;const _=[W.DEFAULT,W.LSTM_ONLY].includes(n)&&!v.legacyCore;let j,I;const N=new Promise((r,i)=>{I=r,j=i}),C=r=>{j(r.message)};let y=_t(v);y.onerror=C,ye+=1;const q=(r,i)=>{L[r]=i},F=(r,i)=>{E[r]=i},b=({id:r,action:i,payload:d})=>new Promise((p,g)=>{ve(`[${l}]: Start ${r}, action=${i}`);const w=`${i}-${r}`;q(w,p),F(w,g),jt(y,{workerId:l,jobId:r,action:i,payload:d})}),J=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),x=r=>b(k({id:r,action:"load",payload:{options:{lstmOnly:_,corePath:v.corePath,logging:v.logging}}})),B=(r,i,d)=>b(k({id:d,action:"FS",payload:{method:"writeFile",args:[r,i]}})),M=(r,i)=>b(k({id:i,action:"FS",payload:{method:"readFile",args:[r,{encoding:"utf8"}]}})),ee=(r,i)=>b(k({id:i,action:"FS",payload:{method:"unlink",args:[r]}})),Y=(r,i,d)=>b(k({id:d,action:"FS",payload:{method:r,args:i}})),oe=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),V=(r,i)=>b(k({id:i,action:"loadLanguage",payload:{langs:r,options:{langPath:v.langPath,dataPath:v.dataPath,cachePath:v.cachePath,cacheMethod:v.cacheMethod,gzip:v.gzip,lstmOnly:[W.LSTM_ONLY,W.TESSERACT_LSTM_COMBINED].includes(h)&&!v.legacyLang}}})),ne=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),U=(r,i,d,p)=>b(k({id:p,action:"initialize",payload:{langs:r,oem:i,config:d}})),Z=(r="eng",i,d,p)=>{if(_&&[W.TESSERACT_ONLY,W.TESSERACT_LSTM_COMBINED].includes(i))throw Error("Legacy model requested but code missing.");const g=i||h;h=g;const w=d||S;S=w;const $=(typeof r=="string"?r.split("+"):r).filter(P=>!R.includes(P));return R.push(...$),$.length>0?V($,p).then(()=>U(r,g,w,p)):U(r,g,w,p)},Q=(r={},i)=>b(k({id:i,action:"setParameters",payload:{params:r}})),te=async(r,i={},d={blocks:!0,text:!0,hocr:!0,tsv:!0},p)=>b(k({id:p,action:"recognize",payload:{image:await we(r),options:i,output:d}})),o=(r="Tesseract OCR Result",i=!1,d)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),b(k({id:d,action:"getPDF",payload:{title:r,textonly:i}}))),t=async(r,i)=>{if(_)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return b(k({id:i,action:"detect",payload:{image:await we(r)}}))},s=async()=>(y!==null&&($t(y),y=null),Promise.resolve());Pt(y,({workerId:r,jobId:i,status:d,action:p,data:g})=>{const w=`${p}-${i}`;if(d==="resolve"){ve(`[${r}]: Complete ${i}`);let D=g;p==="recognize"?D=At(g):p==="getPDF"&&(D=Array.from({...g,length:Object.keys(g).length})),L[w]({jobId:i,data:D})}else if(d==="reject")if(E[w](g),p==="load"&&j(g),f)f(g);else throw Error(g);else d==="progress"&&m({...g,userJobId:i})});const u={id:l,worker:y,setResolve:q,setReject:F,load:J,writeText:B,readText:M,removeFile:ee,FS:Y,loadLanguage:oe,initialize:ne,reinitialize:Z,setParameters:Q,recognize:te,getPDF:o,detect:t,terminate:s};return x().then(()=>V(e)).then(()=>U(e,n,c)).then(()=>I(u)).catch(()=>{}),N};const ke=Ee,It=async(e,n,a)=>{const c=await ke(n,1,a);return c.recognize(e).finally(async()=>{await c.terminate()})},Nt=async(e,n)=>{const a=await ke("osd",0,n);return a.detect(e).finally(async()=>{await a.terminate()})};var Ct={recognize:It,detect:Nt},Mt={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},Dt={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const zt=Ie,Gt=Ee,Ft=Ct,Ut=Mt,Wt=Se,qt=Dt,{setLogging:Bt}=K;var Yt={languages:Ut,OEM:Wt,PSM:qt,createScheduler:zt,createWorker:Gt,setLogging:Bt,...Ft};let z,G,ce,O,A,le,Oe,be=0,Ae;const T={treshold:70,run:!1},H={};async function Ht(){z=640,G=0,O=document.querySelector("#video"),A=document.querySelector("#videoPreview"),le=document.querySelector("#videoAnalyze"),Oe=document.querySelector("#resultView"),ce=!1,Ae=await Yt.createWorker()}async function Kt(){const e=[{label:"none",id:null}];try{let n=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0});(await navigator.mediaDevices.enumerateDevices()).forEach(c=>{console.log("device.label :",c.label),console.table(c),c.kind=="videoinput"&&e.push({label:c.label,id:c.deviceId})})}catch(n){console.log("error in getting device list",n)}return e}async function Jt(e){try{let n=await navigator.mediaDevices.getUserMedia({video:{deviceId:e},audio:!1});O.srcObject=n,O.play(),O.addEventListener("canplay",a=>{ce||(G=O.videoHeight/O.videoWidth*z,O.setAttribute("width",z),O.setAttribute("height",G),A.setAttribute("width",z),A.setAttribute("height",G),ce=!0)},!1)}catch(n){console.log("error getting stream ",n)}}function xt(){let e=A.getContext("2d",{willReadFrequently:!0});e.drawImage(O,0,0,O.videoWidth,O.videoHeight,0,0,z,G),Zt(e),e.rect(z*.222,G*.333,z*.555,G*.333),e.lineWidth=6,e.strokeStyle="green",e.stroke()}function Vt(e){return T.treshold}function Zt(e){let n=e.getImageData(0,0,A.width,A.height),a=n.data;T.treshold=Vt();const c=Math.floor(T.treshold/100*255);for(let l=0;l<a.length;l+=4){const m=a[l],f=a[l+1],v=a[l+2],L=.2126*m+.7152*f+.0722*v;let E;L>=c?E=255:E=0,a[l]=a[l+1]=a[l+2]=E}e.putImageData(n,0,0)}function Qt(){window.requestAnimationFrame(Te)}async function Te(e){e-be>600&&(be=e,xt(),await Xt(),Oe.textContent=H.confidence+" "+H.result+" "+T.treshold),T.run&&window.requestAnimationFrame(Te)}async function Xt(){H.confidence=0,H.result=null,le.getContext("2d").drawImage(A,A.width*.222,A.height*.333,A.width*.555,A.height*.333,0,0,z,G*.555);let n=new Image;n.src=le.toDataURL("image/png");const a=await Ae.recognize(n);console.log(a),H.confidence=a.data.confidence,a?.data?.confidence>50&&(H.result=a.data.text)}Ht();let fe=document.createElement("select");fe.onchange=e=>T.treshold=e.target.value;let he=document.querySelector("#controls");he.appendChild(fe);let er=[10,20,30,40,50,60,70,80,90];er.map(e=>{let n=document.createElement("option");n.setAttribute("value",e),e==70&&n.setAttribute("selected",!0),n.textContent=e,fe.appendChild(n)});let Re=await Kt(),ie=null;console.log(Re);const pe=document.createElement("select");he.appendChild(pe);document.querySelector("#video");document.querySelector("#videoPreview");Re.forEach(e=>{let n=document.createElement("option");n.setAttribute("value",e.id),n.textContent=e.label,pe.appendChild(n)});pe.onchange=e=>{ie=e.target.value,console.log(ie),Jt(ie)};const X=document.createElement("button");X.textContent="Start";he.appendChild(X);X.onclick=()=>{T.run=!T.run,T.run?X.textContent="Stop":X.textContent="Start",T.run&&Qt()};
